


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Poisson Equation with Zero Neumann Boundary Condition &mdash; discretize 0.6.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/logo-block.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Advection and Diffusion with Zero Neumann Boundary Condition" href="derivation_examples_advection_diffusion.html" />
    <link rel="prev" title="Solving PDEs Examples" href="derivation_examples_index.html" />
 

<meta name="description" content="Simulation and Parameter Estimation in Geophysics">
<meta name="author" content="SimPEG Developers">
<meta name="keywords" content="python, geophysics, inversion, electromagnetics, magnetotellurics, magnetics, gravity, DC, flow inverse problems, open source, finite volume">


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45185336-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> discretize
          

          
          </a>

          
            
            
              <div class="version">
                0.6.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../big_picture.html">Why discretize?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional_resources.html">Additional Resources</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/mesh_generation/index.html">Mesh Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/operators/index.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/inner_products/index.html">Inner Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/pde/index.html">Solving PDEs</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Theory</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../finite_volume_index.html">Intoduction to Finite Volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="meshes_index.html">Meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="operators_index.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="inner_products_index.html">Inner Products</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="derivation_examples_index.html">Solving PDEs Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Poisson Equation with Zero Neumann Boundary Condition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#electic-potential-on-the-nodes">Electic Potential on the Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#electic-potential-at-cell-centers">Electic Potential at Cell Centers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="derivation_examples_advection_diffusion.html">Advection and Diffusion with Zero Neumann Boundary Condition</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Meta Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../release/index.html">Release Notes</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting connected
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://simpeg.xyz"><i class="fa fa-external-link-square fa-fw"></i> SimPEG</a></li>
            
                <li class="toctree-l1"><a href="http://slack.simpeg.xyz"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/simpeg/discretize"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">discretize</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="derivation_examples_index.html">Solving PDEs Examples</a> &raquo;</li>
        
      <li>Poisson Equation with Zero Neumann Boundary Condition</li>
    
    

    <li class="wy-breadcrumbs-aside">
        
            
                <a href="https://github.com/simpeg/discretize/edit/master/doc/content/theory/derivation_examples_poisson.rst"
                   class="fa fa-github"> Edit this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="poisson-equation-with-zero-neumann-boundary-condition">
<span id="derivation-examples-poisson"></span><h1>Poisson Equation with Zero Neumann Boundary Condition<a class="headerlink" href="#poisson-equation-with-zero-neumann-boundary-condition" title="Permalink to this headline">Â¶</a></h1>
<p>Here we provide the derivation for solving the Poisson equation with zero Neumann boundary conditions using the finite volume method.
Derivations are provided for discretization of the solution on both the nodes and at cell centers.
Key lessons include:</p>
<blockquote>
<div><ul class="simple">
<li><p>Differences between solving the problem on the nodes and the cell centers</p></li>
<li><p>Basic discretization of point sources</p></li>
<li><p>Choosing the right approach for natural boundary conditions</p></li>
<li><p>Implementing the zero Neumann condition when the discrete boundary condition term is not zero</p></li>
</ul>
</div></blockquote>
<p>For our example, we consider Gaussâs law of electrostatics.
Our goal is to compute the electric potential (<span class="math notranslate nohighlight">\(\phi\)</span>) and electric fields (<span class="math notranslate nohighlight">\(\boldsymbol{e}\)</span>) that result from
a positive and a negative point charge separated by some distance.</p>
<p><strong>Tutorial:</strong> <a class="reference internal" href="../../tutorials/pde/1_poisson.html#sphx-glr-tutorials-pde-1-poisson-py"><span class="std std-ref">Poisson Equation with Zero Neumann Boundary Condition</span></a></p>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">Â¶</a></h2>
<p>Starting with Gaussâs law and Faradayâs law:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-1">
<span class="eqno">(1)<a class="headerlink" href="#equation-derivation-examples-electrostatics-1" title="Permalink to this equation">Â¶</a></span>\[\begin{split}&amp;\nabla \cdot \vec{e} = \frac{\rho}{\epsilon_0} \\
&amp;\nabla \times \vec{e} = \boldsymbol{0} \;\;\; \Rightarrow \;\;\; \vec{e} = -\nabla \phi \\
&amp;\textrm{s.t.} \;\;\; \hat{n} \cdot \vec{e} \, \Big |_{\partial \Omega} = -\frac{\partial \phi}{\partial n} \, \Big |_{\partial \Omega} = 0\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the charge density and <span class="math notranslate nohighlight">\(\epsilon_0\)</span> is the permittivity of free space.
The Neumann boundary condition on <span class="math notranslate nohighlight">\(\phi\)</span> implies no electric flux leaves the system.
For 2 point charges of equal and opposite sign, the charge density is given by:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-2">
<span class="eqno">(2)<a class="headerlink" href="#equation-derivation-examples-electrostatics-2" title="Permalink to this equation">Â¶</a></span>\[\rho = \rho_0 \big [ \delta ( \boldsymbol{r_+}) - \delta (\boldsymbol{r_-} ) \big ]\]</div>
<p>To solve this problem numerically, we first
take the inner product of each equation with an appropriate test function.
Where <span class="math notranslate nohighlight">\(\psi\)</span> is a scalar test function and <span class="math notranslate nohighlight">\(\vec{u}\)</span> is a
vector test function:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-3">
<span class="eqno">(3)<a class="headerlink" href="#equation-derivation-examples-electrostatics-3" title="Permalink to this equation">Â¶</a></span>\[\int_\Omega \psi (\nabla \cdot \vec{e}) \, dv = \frac{1}{\epsilon_0} \int_\Omega \psi \rho \, dv\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-4">
<span class="eqno">(4)<a class="headerlink" href="#equation-derivation-examples-electrostatics-4" title="Permalink to this equation">Â¶</a></span>\[\int_\Omega \vec{u} \cdot \vec{e} \, dv = - \int_\Omega \vec{u} \cdot (\nabla \phi ) \, dv\]</div>
<p>In the case of Gaussâ law, we have a volume integral containing the Dirac delta function.
Thus expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-3">(3)</a> becomes:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-5">
<span class="eqno">(5)<a class="headerlink" href="#equation-derivation-examples-electrostatics-5" title="Permalink to this equation">Â¶</a></span>\[\int_\Omega \psi (\nabla \cdot \vec{e}) \, dv = \frac{1}{\epsilon_0} \psi \, q\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> represents an integrated charge density.
To apply the finite volume method, we must choose whether to discretize the scalar quantity <span class="math notranslate nohighlight">\(\phi\)</span> at the nodes or cell centers.</p>
</div>
<div class="section" id="electic-potential-on-the-nodes">
<h2>Electic Potential on the Nodes<a class="headerlink" href="#electic-potential-on-the-nodes" title="Permalink to this headline">Â¶</a></h2>
<p>Here, we let <span class="math notranslate nohighlight">\(\boldsymbol{\phi}\)</span> be the discrete representation of the electic potential <span class="math notranslate nohighlight">\(\phi\)</span> on the nodes
and <span class="math notranslate nohighlight">\(\boldsymbol{e}\)</span> be the discrete representation of the electic field <span class="math notranslate nohighlight">\(\vec{e}\)</span> on the edges.</p>
<p><strong>First Expression:</strong></p>
<p>To implement the finite volume approach, we begin by approximating the inner products in expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-4">(4)</a>.
The left-hand side can be approximated according to <a class="reference internal" href="inner_products_basic.html#inner-products-basic"><span class="std std-ref">basic inner products</span></a> .
And in <a class="reference internal" href="inner_products_differential.html#inner-products-differential"><span class="std std-ref">inner products with differential operators</span></a>, we learned how to approximate the right-hand side.
The discrete representation of expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-4">(4)</a> is therefore given by:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-6">
<span class="eqno">(6)<a class="headerlink" href="#equation-derivation-examples-electrostatics-6" title="Permalink to this equation">Â¶</a></span>\[\boldsymbol{u^T M_e \, e} = - \boldsymbol{u^T M_e G \, \phi}\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{M_e}\)</span> is the <a class="reference internal" href="inner_products_basic.html#inner-products-basic"><span class="std std-ref">inner product matrix at edges</span></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{G}\)</span> is the <a class="reference internal" href="inner_products_differential.html#inner-products-differential"><span class="std std-ref">discrete gradient operator</span></a></p></li>
</ul>
</div></blockquote>
<p><strong>Second Expression:</strong></p>
<p>Now we approximate the inner products in expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-5">(5)</a>.
For the left-hand side, we must use the identity <span class="math notranslate nohighlight">\(\psi \nabla \cdot \vec{e} = \nabla \cdot \psi\vec{e} - \vec{e} \cdot \nabla \psi\)</span>
and apply the divergence theorem such that expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-5">(5)</a> becomes:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-7">
<span class="eqno">(7)<a class="headerlink" href="#equation-derivation-examples-electrostatics-7" title="Permalink to this equation">Â¶</a></span>\[- \int_\Omega \vec{e} \cdot \nabla \psi \, dv + \oint_{\partial \Omega} \psi (\hat{n} \cdot \vec{e}) \, da = \frac{1}{\epsilon_0} \psi \, q\]</div>
<p>Since <span class="math notranslate nohighlight">\(\hat{n} \cdot \vec{e}\)</span> is zero on the boundary, the surface integral is equal to zero.
The left-hand side can be approximated according to <a class="reference internal" href="inner_products_differential.html#inner-products-differential"><span class="std std-ref">inner products with differential operators</span></a>.
<span class="math notranslate nohighlight">\(\boldsymbol{\psi}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> are defined such that their discrete representations <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(\rho\)</span>
must live on the nodes. The discrete approximation to expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-7">(7)</a> is given by:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-8">
<span class="eqno">(8)<a class="headerlink" href="#equation-derivation-examples-electrostatics-8" title="Permalink to this equation">Â¶</a></span>\[- \boldsymbol{\psi^T G^T M_e \, e} = \frac{1}{\epsilon_0} \boldsymbol{\psi^T q}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> is a discrete representation of the integrated charge density.</p>
<p>The easiest way to discretize the source is to let <span class="math notranslate nohighlight">\(\boldsymbol{q_i}=\rho_0\)</span> at the nearest node to the positive charge and
let <span class="math notranslate nohighlight">\(\boldsymbol{q_i}=-\rho_0\)</span> at the nearest node to the negative charge.
The value is zero for all other nodes.</p>
<p><strong>Discretized System:</strong></p>
<p>By combining the discrete representations from expressions <a class="reference internal" href="#equation-derivation-examples-electrostatics-6">(6)</a> and <a class="reference internal" href="#equation-derivation-examples-electrostatics-8">(8)</a>
we obtain:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-9">
<span class="eqno">(9)<a class="headerlink" href="#equation-derivation-examples-electrostatics-9" title="Permalink to this equation">Â¶</a></span>\[\boldsymbol{G^T M_e G \, \phi} = \frac{1}{\epsilon_0} \boldsymbol{q}\]</div>
<p>Let <span class="math notranslate nohighlight">\(\boldsymbol{A} = \boldsymbol{G^T M_e G}\)</span>.
The linear system has a single null vector.
To remedy this, we set a reference potential on the boundary
by setting <span class="math notranslate nohighlight">\(A_{0,0} = 1\)</span> and by setting all other values in the row to 0.
Once the electric potential at nodes has been computed, the electric field on the edges can be computed using expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-6">(6)</a>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{e} = - \boldsymbol{G \, \phi}\]</div>
</div>
<div class="section" id="electic-potential-at-cell-centers">
<h2>Electic Potential at Cell Centers<a class="headerlink" href="#electic-potential-at-cell-centers" title="Permalink to this headline">Â¶</a></h2>
<p>Here, we let <span class="math notranslate nohighlight">\(\boldsymbol{\phi}\)</span> be the discrete representation of the electic potential <span class="math notranslate nohighlight">\(\phi\)</span> at cell centers
and <span class="math notranslate nohighlight">\(\boldsymbol{e}\)</span> be the discrete representation of the electic field <span class="math notranslate nohighlight">\(\vec{e}\)</span> on the faces.
It is acceptable to discretize the electric field on the faces in this case because the dielectric permittivity of the domain
is constant and the electric field at the faces is continuous.</p>
<p><strong>First Expression:</strong></p>
<p>To implement the finite volume approach, we begin by approximating the inner products in expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-5">(5)</a>.
The left-hand side can be approximated according to <a class="reference internal" href="inner_products_differential.html#inner-products-differential"><span class="std std-ref">inner products with differential operators</span></a>.
Where <span class="math notranslate nohighlight">\(\boldsymbol{\psi}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> are discrete representations of <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(\rho\)</span> living at cell centers:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-10">
<span class="eqno">(10)<a class="headerlink" href="#equation-derivation-examples-electrostatics-10" title="Permalink to this equation">Â¶</a></span>\[\boldsymbol{\psi^T M_c D e} = \frac{1}{\epsilon_0} \boldsymbol{\psi^T q}\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{M_c}\)</span> is the <a class="reference internal" href="inner_products_basic.html#inner-products-basic"><span class="std std-ref">inner product matrix at cell centers</span></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{D}\)</span> is the <a class="reference internal" href="inner_products_differential.html#inner-products-differential"><span class="std std-ref">discrete divergence operator</span></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> is a discrete representation for the integrated charge density for each cell.</p></li>
</ul>
</div></blockquote>
<p>In this case, <span class="math notranslate nohighlight">\(\boldsymbol{q_i}=\rho_0\)</span> at the center of the cell containing the positive charge and
<span class="math notranslate nohighlight">\(\boldsymbol{q_i}=-\rho_0\)</span> at the center of the cell containing the negative charge.
It is zero for every other cell.</p>
<p><strong>Second Expression:</strong></p>
<p>We now approximate the inner products in expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-4">(4)</a>.
The left-hand side can be approximated according to <a class="reference internal" href="inner_products_basic.html#inner-products-basic"><span class="std std-ref">basic inner products</span></a> .
And in <a class="reference internal" href="inner_products_differential.html#inner-products-differential"><span class="std std-ref">inner products with differential operators</span></a>, we learned how to approximate the right-hand side.
For the right-hand side, we must use the identity <span class="math notranslate nohighlight">\(\vec{u} \cdot \nabla \phi = \nabla \cdot \phi\vec{u} - \phi \nabla \cdot \vec{u}\)</span>
and apply the divergence theorem such that expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-4">(4)</a> becomes:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-11">
<span class="eqno">(11)<a class="headerlink" href="#equation-derivation-examples-electrostatics-11" title="Permalink to this equation">Â¶</a></span>\[\int_\Omega \vec{u} \cdot \vec{e} \, dv = \int_\Omega \phi \nabla \cdot \vec{u} \, dv - \oint_{\partial \Omega} \phi \hat{n} \cdot \vec{u} \, da\]</div>
<p>According to expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-1">(1)</a>, <span class="math notranslate nohighlight">\(\hat{n} \cdot \vec{e}\)</span>,
:math:<a href="#id1"><span class="problematic" id="id2">`</span></a>frac{partial phi}{partial n} = 0 on the boundaries.
To accurately compute the electric potentials at cell centers, we must implement the boundary conditions such that:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-12">
<span class="eqno">(12)<a class="headerlink" href="#equation-derivation-examples-electrostatics-12" title="Permalink to this equation">Â¶</a></span>\[\boldsymbol{u^T M_f \, e} = \boldsymbol{u^T D^T M_c \, \phi} - \boldsymbol{u^T B \, \phi} = - \boldsymbol{\tilde{G} \, \phi}\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{M_c}\)</span> is the <a class="reference internal" href="inner_products_basic.html#inner-products-basic"><span class="std std-ref">inner product matrix at cell centers</span></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{M_f}\)</span> is the <a class="reference internal" href="inner_products_basic.html#inner-products-basic"><span class="std std-ref">inner product matrix at faces</span></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{D}\)</span> is the <a class="reference internal" href="inner_products_differential.html#inner-products-differential"><span class="std std-ref">discrete divergence operator</span></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> is a sparse matrix that imposes the Neumann boundary condition</p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{\tilde{G}} = - \boldsymbol{D^T M_c} + \boldsymbol{B}\)</span> acts as a modified gradient operator with boundary conditions included</p></li>
</ul>
</div></blockquote>
<p><strong>Discretized System:</strong></p>
<p>By combining the discrete representations from expressions <a class="reference internal" href="#equation-derivation-examples-electrostatics-10">(10)</a> and <a class="reference internal" href="#equation-derivation-examples-electrostatics-12">(12)</a>
we obtain:</p>
<div class="math notranslate nohighlight" id="equation-derivation-examples-electrostatics-13">
<span class="eqno">(13)<a class="headerlink" href="#equation-derivation-examples-electrostatics-13" title="Permalink to this equation">Â¶</a></span>\[- \boldsymbol{M_c D M_f^{-1} \tilde{G} \, \phi} = \frac{1}{\epsilon_0} \boldsymbol{q}\]</div>
<p>Once the electric potential at cell centers has been computed, the electric field on the faces can be computed using expression <a class="reference internal" href="#equation-derivation-examples-electrostatics-12">(12)</a>:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{e} = - \boldsymbol{M_f^{-1} \tilde{G} \, \phi}\]</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="derivation_examples_advection_diffusion.html" class="btn btn-neutral float-right" title="Advection and Diffusion with Zero Neumann Boundary Condition" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="derivation_examples_index.html" class="btn btn-neutral float-left" title="Solving PDEs Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" width="60px"; style="float:right;height:3em;line-height:3em;padding:10px 0 0 1em;">
        <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
    </a>
    2013-2020,
    <a href="http://simpeg.xyz">SimPEG Developers.</a><br />
    Except where noted, this work is licensed under a <br />
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        Creative Commons Attribution 4.0 International License
    </a>
</div>
<br>
<div>
Built with
    <a href="http://sphinx-doc.org/">Sphinx</a>
    using a
    <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
    provided by
    <a href="https://readthedocs.org">Read the Docs</a>.
 </div>


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>